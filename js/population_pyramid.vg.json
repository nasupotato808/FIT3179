{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "POPULATION PYRAMID (2004 - 2024)",
    "fontSize": 24,
    "font": "Heltica",
    "fontWeight": "bold",
    "anchor": "middle"
  },
  "width": 500,
  "data": {
    "url": "https://raw.githubusercontent.com/nasupotato808/FIT3179/refs/heads/main/data/population_state.csv",
    "format": { "type": "csv" }
  },
  "params": [
    {
      "name": "Year_selection",
      "value": 2020,
      "bind": {
        "input": "range",
        "min": 2004,
        "max": 2024,
        "step": 1,
        "name": "Year: "
      }
    },
    {
      "name": "State_selection",
      "value": "Johor",
      "bind": {
        "input": "select",
        "options": [
          "Johor",
          "Selangor",
          "Sabah",
          "Sarawak",
          "W.P. Putrajaya",
          "W.P. Kuala Lumpur",
          "W.P. Labuan",
          "Kedah",
          "Kelantan",
          "Negeri Sembilan",
          "Pahang",
          "Melaka",
          "Perak",
          "Perlis",
          "Pulau Pinang",
          "Terengganu"
        ],
        "name": "State: "
      }
    }
  ],
  "hconcat": [
    {
      "width": 210,
      "transform": [
        {
          "filter": "datum.sex == 'female' && datum.age != 'overall' && datum.ethnicity== 'overall' && year(datum.date) == Year_selection && datum.state == State_selection"
        }
      ],
      "mark": "bar",
      "encoding": {
        "y": {
          "field": "age",
          "type": "ordinal",
          "sort": [
            "0-4",
            "5-9",
            "10-14",
            "15-19",
            "20-24",
            "25-29",
            "30-34",
            "35-39",
            "40-44",
            "45-49",
            "50-54",
            "55-59",
            "60-64",
            "65-69",
            "70-74",
            "75-79",
            "80-84",
            "85+"
          ],
          "axis": null
        },
        "x": {
          "field": "population",
          "type": "quantitative",
          "title": "Female Population('000)",
          "axis": { "format": "s", "labelFontSize": 14, "titleFontSize": 12 },
          "scale": { "zero": true },
          "sort": "descending"
        },
        "color": {
          "value": "#FF69B4"
        },
        "tooltip": [
          { "field": "age", "type": "ordinal", "title": "Age Group" },
          {
            "field": "population",
            "type": "quantitative",
            "title": "Female Population('000)",
            "format": ",.0f"
          },
          { "field": "state", "type": "nominal", "title": "State" },
          {
            "field": "date",
            "type": "temporal",
            "title": "Year",
            "timeUnit": "year"
          }
        ]
      }
    },
    {
      "width": 80,
      "view": { "stroke": null },
      "title": {
        "text": "Age",
        "fontSize": 14,
        "font": "Helvetica",
        "fontWeight": "bold",
        "anchor": "middle"
      },
      "layer": [
        {
          "mark": {
            "type": "text",
            "align": "center",
            "fontSize": 16
          },
          "transform": [
            {
              "filter": "datum.sex == 'female' && datum.age != 'overall' && datum.ethnicity== 'overall' && year(datum.date) == Year_selection && datum.state == State_selection"
            }
          ],
          "encoding": {
            "y": {
              "field": "age",
              "type": "ordinal",
              "sort": [
                "0-4",
                "5-9",
                "10-14",
                "15-19",
                "20-24",
                "25-29",
                "30-34",
                "35-39",
                "40-44",
                "45-49",
                "50-54",
                "55-59",
                "60-64",
                "65-69",
                "70-74",
                "75-79",
                "80-84",
                "85+"
              ],
              "axis": null
            },
            "text": { "field": "age" }
          }
        }
      ]
    },
    {
      "width": 210,
      "transform": [
        {
          "filter": "datum.sex == 'male' && datum.age != 'overall' && datum.ethnicity== 'overall' && year(datum.date) == Year_selection && datum.state == State_selection"
        }
      ],
      "mark": "bar",
      "encoding": {
        "y": {
          "field": "age",
          "type": "ordinal",
          "sort": [
            "0-4",
            "5-9",
            "10-14",
            "15-19",
            "20-24",
            "25-29",
            "30-34",
            "35-39",
            "40-44",
            "45-49",
            "50-54",
            "55-59",
            "60-64",
            "65-69",
            "70-74",
            "75-79",
            "80-84",
            "85+"
          ],
          "axis": null
        },
        "x": {
          "field": "population",
          "type": "quantitative",
          "title": "Male Population('000)",
          "axis": { "format": "s", "labelFontSize": 14, "titleFontSize": 12 },
          "scale": { "zero": true }
        },
        "color": {
          "value": "#1E90FF"
        },
        "tooltip": [
          { "field": "age", "type": "ordinal", "title": "Age Group" },
          {
            "field": "population",
            "type": "quantitative",
            "title": "Male Population('000)",
            "format": ",.0f"
          },
          { "field": "state", "type": "nominal", "title": "State" },
          {
            "field": "date",
            "type": "temporal",
            "title": "Year",
            "timeUnit": "year"
          }
        ]
      }
    }
  ],
  "config": {
    "view": { "stroke": null },
    "axis": { "grid": false }
  }
}
